# 图编译统计信息导出功能

## 功能简介

在线或离线图编译过程中，提供编译过程中统计信息导出功能（当前包括图融合和UB融合信息，即fusion\_result.json），实现程序异常退出时也能生成编译结果，方便用户进行问题定位和分析。

> **说明：** 
>算子融合分为图融合和UB（Unified Buffer）融合两种，更详细的介绍请参考[《CANN 图融合和UB融合规则参考》](https://hiascend.com/document/redirect/CannCommunitygraphubfusionref)。

## 使用约束

本功能仅支持max-autotune模式。

## 使用方法

该功能通过[torchair.get\_npu\_backend](get_npu_backend.md)中compiler\_config配置，示例如下，仅供参考不支持直接拷贝运行，参数说明如下表。

```
import torch_npu, torchair
config = torchair.CompilerConfig()
# 图编译统计信息导出功能开关
config.ge_config.export_compile_stat = "2"
npu_backend = torchair.get_npu_backend(compiler_config=config)
opt_model = torch.compile(model, backend=npu_backend)
```

**表 1**  参数说明


| 参数名 | 说明 |
| --- | --- |
| export_compile_stat | 图编译过程中是否生成统计信息（当前包括图融合/UB融合结果信息），字符串类型。<br>- 0：关闭，不生成统计信息。<br>- 1：程序运行正常退出时生成统计信息。<br>- 2（默认值）：图编译完成时生成统计信息。 |

## 产物说明

开启本功能后，如果图编译执行中断，依然会有文件保存，默认在当前执行路径下生成fusion\_result.json，内容示例参见[算子融合规则配置功能 > 产物说明](算子融合规则配置功能（fusion_switch_file）.md#产物说明)。

